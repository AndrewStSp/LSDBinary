# LSDBinary: pushing least-squares deconvolution (LSD) to the next level by generalising it to binary stars

## Motivation
With the amount, and more importantly unprecedented quality of (space-based) photometric and (ground-based) spectroscopic observations available nowadays, considerable time and effort are being spent to improve methods and techniques for the analysis of stars in binary and higher order multiple systems. The need to achieve extremely high signal-to-noise ratio (S/N) to be able to detected low-amplitude magnetic signatures in polarisation spectra has driven development of the Least-Squares Deconvolution (LSD; Donati et al. 1997, MNRAS, 291, 658) multi-line averaging technique. The LSD profiles obtained with this methods are also ideal for inference of radial velocities of stars (including those in binary systems) and to study temporal spectral changes due to intrinsic variability of stars. Here, we present a generalisation of the original LSD method to binary stars. In particular, we focus on the determination of precise, orbital phase-resolved radial velocities (RV) of the individual binary components with a careful treatment of the Rossiter-McLaughlin effect (Rossiter 1924, ApJ, 60, 15; McLaughlin 1924, ApJ, 60, 22).
## Problem formulation
The LSD method is by design sensitive to signals that are common to the majority of spectral lines in stellar spectrum. Therefore, even under the assumption of a single line mask *M*, LSD remains a powerful method for detection of SB2 binary systems. For example, the LSD profile computed from the composite spectrum of a SB2 system and employing a line mask corresponding to the primary component, will contain signatures of both binary components with a caveat that contribution of the secondary component to the LSD profile will be somewhat diluted. Measuring RVs and/or studying line profile variations (LPV) of individual binary components in these composite LSD profile still proves nearly as difficult as from the original observed composite spectra because, despite the significantly enhanced S/N in the LSD profile, line blending remains the dominant source of uncertainty. In practice, this means that the original LSD method as well as its numerous generalisations (e.g., Kochukhov et al. 2010, A&A, 524, A5; Sennhauser et al. 2009, A&A, 507, 1711; Sennhauser & Berdyugina 2010, A&A, 522, A57; Tkachenko et al. 2013, A&A, 560, A37; Asensio Ramos & Petit 2015, A&A, 583, A51; Strachan & Anglada-Escud√© 2017, MNRAS, 472, 3467), despite being effective for the detection of SB2 systems, are however not suitable for the calculation of LSD profiles of the individual binary components and inference of their precise RVs thereof.
Here, we ocus on separation of spectral contributions of the individual binary components in velocity space to the level of precision that would enable inference of precise and accurate RVs of both stars and, if possible, resolving their LPVs. In doing so, we focus primarily on the difficult case of the in-eclipse orbital phases that are characterised by high degree of blending, while we pay little attention to the out-of-eclipse phases where spectral contributions of the two stars can typically be easily separated from each other. This specific focus on the in-eclipse spectra is made solely for the purpose of demonstrating the algorithm's performance in the most difficult circumstances, while the algorithm is designed such as to handle all orbital phases in the spectroscopic observations of eclipsing SB2 systems. As a baseline, we adopt the modified LSD method by Tkachenko et al. (2013) that employs a modified, fast version of the Levenberg-Marquardt algorithm (Marquardt 1963, SIAM Journal on Applied Mathematics, 11, 431) implemented by Piskunov & Kochukhov (2002, A&A, 381, 736). The algorithm has the capabilities as outlined in Tkachenko et al. (2013) and serves as the ``central engine'' of the LSDBinary software package presented here.
## Brief description of the LSDBinary algorithm
Figure below provides a flow chart of the LSDBinary software package with the three main components - input, central engine, output - being indicated.
![Box_diagram](https://user-images.githubusercontent.com/19326373/181260427-b940b29e-8b1d-4918-b09e-a2a9d9b2da6e.jpeg)
Here, we provide a more detailed description of the entire process, in the form of a pseudo-code:
